const dom = document.getElementById('chart-container');
const myChart = echarts.init(dom, null, {
	renderer: 'canvas',
	useDirtyRect: false
});
const app = {};

const COLORS = ['#5470c6', '#3ba272', '#91cc75', '#73c0de', '#fac858', '#fc8452', '#ee6666', /* not used */'#9a60b4', '#ea7ccc']

const hotelDataURI = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASBAMAAACk4JNkAAAAGFBMVEUAAACAgID+YwH/zgDAwMD///8AAAD/kUszE+1FAAAAAXRSTlMAQObYZgAAAF1JREFUeF59yjsOgCAQBFCqPYFewMILkNCbLPYmLDWJMAfg/h9xwRgbp3qZGfNNegAMkpTYVSJES2KRsN/KvB0+JBVPojNlngX6c9ljVVmHZcjWH51NMJ21oVPx5gKW+RUFTeNT9AAAAABJRU5ErkJggg=='

const CONNECTIONS = [
	{ origin:  0, destinations: [ 7, 10] },
	{ origin:  1, destinations: [10, 28] },
	{ origin:  2, destinations: [ 3, 30] },
	{ origin:  3, destinations: [ 9, 21] },
	{ origin:  4, destinations: [20, 11] },
	{ origin:  5, destinations: [21,  8] },
	{ origin:  6, destinations: [11, 24] },
	{ origin:  7, destinations: [ 1, 16] },
	{ origin:  8, destinations: [20,  6] },
	{ origin:  9, destinations: [ 2, 26] },
	{ origin: 10, destinations: [17, 29] },
	{ origin: 11, destinations: [27, 24] },
	{ origin: 12, destinations: [10, 28] },
	{ origin: 13, destinations: [22, 19] },
	{ origin: 14, destinations: [ 7,  4] },
	{ origin: 15, destinations: [26, 25] },
	{ origin: 16, destinations: [23, 18] },
	{ origin: 17, destinations: [16,  3] },
	{ origin: 18, destinations: [25,  4] },
	{ origin: 19, destinations: [17,  5] },
	{ origin: 20, destinations: [15, 19] },
	{ origin: 21, destinations: [13, 12] },
	{ origin: 22, destinations: [30,  6] },
	{ origin: 23, destinations: [19, 14] },
	{ origin: 24, destinations: [ 1, 27] },
	{ origin: 25, destinations: [ 8,  2] },
	{ origin: 26, destinations: [ 7, 22] },
	{ origin: 27, destinations: [12,  9] },
	{ origin: 28, destinations: [ 5, 15] },
	{ origin: 29, destinations: [13, 14] },
	{ origin: 30, destinations: [18, 23] },
];

const shortestPaths = {
	1: [
		[0, 7, 1],
		[6, 24, 1],
		[11, 24, 1],
		[14, 7, 1],
		[26, 7, 1],
	],
	2: [
		[0, 7, 16, 18, 25, 2],
		[0, 10, 17, 3, 9, 2],
		[1, 10, 17, 3, 9, 2],
		[4, 11, 24, 27, 9, 2],
		[5, 8, 20, 15, 25, 2],
		[6, 11, 24, 27, 9, 2],
		[6, 11, 24, 27, 9, 2],
		[7, 1, 28, 15, 25, 2],
		[8, 6, 11, 27, 9, 2],
		[8, 6, 24, 27, 9, 2],
		[10, 17, 16, 18, 25, 2],
		[12, 10, 17, 3, 9, 2],
		[13, 22, 30, 18, 25, 2],
		[13, 19, 17, 3, 9, 2],
		[14, 7, 16, 18, 25, 2],
		[14, 4, 20, 15, 25, 2],
		[14, 4, 11, 27, 9, 2],
		[18, 4, 20, 15, 25, 2],
		[18, 4, 20, 15, 25, 2],
		[18, 4, 11, 27, 9, 2],
		[19, 17, 16, 18, 25, 2],
		[20, 19, 17, 3, 9, 2],
		[21, 12, 28, 15, 25, 2],
		[22, 6, 11, 27, 9, 2],
		[22, 6, 24, 27, 9, 2],
		[23, 19, 17, 3, 9, 2],
		[24, 1, 28, 15, 25, 2],
		[26, 7, 16, 18, 25, 2],
		[26, 22, 30, 18, 25, 2],
		[27, 12, 28, 15, 25, 2],
	],
	3: [
		[0, 10, 17, 3],
		[1, 10, 17, 3],
		[12, 10, 17, 3],
		[13, 19, 17, 3],
		[15, 25, 2, 3],
		[18, 25, 2, 3],
		[20, 19, 17, 3],
		[23, 19, 17, 3],
		[27, 9, 2, 3],
	],
	4: [
		[0, 7, 16, 18, 4],
		[0, 10, 29, 14, 4],
		[1, 10, 29, 14, 4],
		[2, 30, 23, 14, 4],
		[7, 16, 23, 14, 4],
		[9, 2, 30, 18, 4],
		[10, 17, 16, 18, 4],
		[12, 10, 29, 14, 4],
		[13, 22, 30, 18, 4],
		[14, 7, 16, 18, 4],
		[14, 7, 16, 18, 4],
		[17, 16, 23, 14, 4],
		[19, 17, 16, 18, 4],
		[22, 30, 23, 14, 4],
		[25, 2, 30, 18, 4],
		[26, 7, 16, 18, 4],
		[26, 22, 30, 18, 4],
	],
	5: [
		[0, 7, 1, 28, 5],
		[2, 30, 23, 19, 5],
		[3, 21, 13, 19, 5],
		[3, 21, 12, 28, 5],
		[6, 24, 1, 28, 5],
		[7, 16, 23, 19, 5],
		[10, 29, 13, 19, 5],
		[11, 27, 12, 28, 5],
		[11, 24, 1, 28, 5],
		[14, 7, 1, 28, 5],
		[14, 4, 20, 19, 5],
		[17, 16, 23, 19, 5],
		[18, 4, 20, 19, 5],
		[22, 30, 23, 19, 5],
		[24, 27, 12, 28, 5],
		[25, 8, 20, 19, 5],
		[26, 7, 1, 28, 5],
	],
	6: [
		[0, 10, 29, 13, 22, 6],
		[1, 10, 29, 13, 22, 6],
		[1, 28, 15, 26, 22, 6],
		[1, 28, 15, 25, 8, 6],
		[2, 3, 9, 26, 22, 6],
		[2, 3, 21, 13, 22, 6],
		[2, 30, 18, 25, 8, 6],
		[4, 20, 15, 26, 22, 6],
		[4, 20, 15, 25, 8, 6],
		[4, 20, 19, 5, 8, 6],
		[7, 1, 28, 5, 8, 6],
		[7, 16, 18, 25, 8, 6],
		[8, 20, 15, 26, 22, 6],
		[8, 20, 15, 26, 22, 6],
		[11, 27, 9, 26, 22, 6],
		[12, 10, 29, 13, 22, 6],
		[12, 28, 15, 26, 22, 6],
		[12, 28, 15, 25, 8, 6],
		[16, 23, 19, 5, 8, 6],
		[17, 16, 18, 25, 8, 6],
		[17, 3, 9, 26, 22, 6],
		[17, 3, 21, 13, 22, 6],
		[19, 5, 21, 13, 22, 6],
		[21, 13, 19, 5, 8, 6],
		[21, 12, 28, 5, 8, 6],
		[22, 30, 18, 25, 8, 6],
		[22, 30, 18, 25, 8, 6],
		[24, 1, 28, 5, 8, 6],
		[24, 27, 9, 26, 22, 6],
		[27, 12, 28, 5, 8, 6],
		[28, 5, 21, 13, 22, 6],
		[29, 13, 19, 5, 8, 6],
		[30, 23, 19, 5, 8, 6],
	],
	7: [
		[0, 7],
		[14, 7],
		[26, 7],
	],
	8: [
		[0, 7, 1, 28, 5, 8],
		[0, 7, 16, 18, 25, 8],
		[2, 30, 23, 19, 5, 8],
		[3, 21, 13, 19, 5, 8],
		[3, 21, 12, 28, 5, 8],
		[6, 24, 1, 28, 5, 8],
		[7, 1, 28, 15, 25, 8],
		[7, 16, 23, 19, 5, 8],
		[9, 2, 30, 18, 25, 8],
		[10, 17, 16, 18, 25, 8],
		[10, 29, 13, 19, 5, 8],
		[11, 27, 12, 28, 5, 8],
		[11, 24, 1, 28, 5, 8],
		[13, 22, 30, 18, 25, 8],
		[14, 7, 1, 28, 5, 8],
		[14, 7, 16, 18, 25, 8],
		[14, 4, 20, 15, 25, 8],
		[14, 4, 20, 19, 5, 8],
		[17, 16, 23, 19, 5, 8],
		[18, 4, 20, 15, 25, 8],
		[18, 4, 20, 15, 25, 8],
		[18, 4, 20, 19, 5, 8],
		[19, 17, 16, 18, 25, 8],
		[21, 12, 28, 15, 25, 8],
		[22, 30, 23, 19, 5, 8],
		[24, 1, 28, 15, 25, 8],
		[24, 27, 12, 28, 5, 8],
		[26, 7, 1, 28, 5, 8],
		[26, 7, 16, 18, 25, 8],
		[26, 22, 30, 18, 25, 8],
		[27, 12, 28, 15, 25, 8],
	],
	9: [
		[0, 10, 17, 3, 9],
		[1, 10, 17, 3, 9],
		[4, 11, 24, 27, 9],
		[6, 11, 24, 27, 9],
		[6, 11, 24, 27, 9],
		[8, 6, 11, 27, 9],
		[8, 6, 24, 27, 9],
		[12, 10, 17, 3, 9],
		[13, 19, 17, 3, 9],
		[14, 4, 11, 27, 9],
		[15, 25, 2, 3, 9],
		[18, 25, 2, 3, 9],
		[18, 4, 11, 27, 9],
		[20, 19, 17, 3, 9],
		[22, 6, 11, 27, 9],
		[22, 6, 24, 27, 9],
		[23, 19, 17, 3, 9],
	],
	10: [
		[0, 10],
		[1, 10],
		[12, 10],
	],
	11: [
		[0, 7, 16, 18, 4, 11],
		[0, 10, 29, 14, 4, 11],
		[1, 10, 29, 14, 4, 11],
		[1, 28, 5, 8, 6, 11],
		[2, 30, 23, 14, 4, 11],
		[3, 9, 26, 22, 6, 11],
		[3, 21, 13, 22, 6, 11],
		[5, 21, 13, 22, 6, 11],
		[7, 16, 23, 14, 4, 11],
		[9, 2, 30, 18, 4, 11],
		[10, 17, 16, 18, 4, 11],
		[10, 29, 13, 22, 6, 11],
		[12, 10, 29, 14, 4, 11],
		[12, 28, 5, 8, 6, 11],
		[13, 22, 30, 18, 4, 11],
		[13, 19, 5, 8, 6, 11],
		[14, 7, 16, 18, 4, 11],
		[14, 7, 16, 18, 4, 11],
		[16, 18, 25, 8, 6, 11],
		[17, 16, 23, 14, 4, 11],
		[19, 17, 16, 18, 4, 11],
		[20, 15, 26, 22, 6, 11],
		[20, 15, 25, 8, 6, 11],
		[20, 19, 5, 8, 6, 11],
		[22, 30, 23, 14, 4, 11],
		[23, 19, 5, 8, 6, 11],
		[25, 2, 30, 18, 4, 11],
		[26, 7, 16, 18, 4, 11],
		[26, 22, 30, 18, 4, 11],
		[27, 9, 26, 22, 6, 11],
		[28, 15, 26, 22, 6, 11],
		[28, 15, 25, 8, 6, 11],
		[30, 18, 25, 8, 6, 11],
	],
	12: [
		[0, 10, 17, 3, 21, 12],
		[1, 10, 17, 3, 21, 12],
		[4, 20, 19, 5, 21, 12],
		[5, 8, 6, 11, 27, 12],
		[5, 8, 6, 24, 27, 12],
		[7, 1, 28, 5, 21, 12],
		[8, 20, 19, 5, 21, 12],
		[8, 6, 11, 24, 27, 12],
		[13, 22, 6, 11, 27, 12],
		[13, 22, 6, 24, 27, 12],
		[13, 19, 17, 3, 21, 12],
		[14, 4, 11, 24, 27, 12],
		[15, 25, 2, 3, 21, 12],
		[16, 23, 19, 5, 21, 12],
		[16, 18, 4, 11, 27, 12],
		[18, 25, 2, 3, 21, 12],
		[18, 4, 11, 24, 27, 12],
		[20, 19, 17, 3, 21, 12],
		[22, 6, 11, 24, 27, 12],
		[23, 19, 17, 3, 21, 12],
		[23, 14, 4, 11, 27, 12],
		[24, 1, 28, 5, 21, 12],
		[25, 8, 6, 11, 27, 12],
		[25, 8, 6, 24, 27, 12],
		[26, 22, 6, 11, 27, 12],
		[26, 22, 6, 24, 27, 12],
		[27, 9, 2, 3, 21, 12],
		[27, 9, 2, 3, 21, 12],
		[29, 13, 19, 5, 21, 12],
		[29, 14, 4, 11, 27, 12],
		[30, 18, 4, 11, 27, 12],
		[30, 23, 19, 5, 21, 12],
	],
	13: [
		[0, 10, 29, 13],
		[1, 10, 29, 13],
		[2, 3, 21, 13],
		[12, 10, 29, 13],
		[17, 3, 21, 13],
		[19, 5, 21, 13],
		[28, 5, 21, 13],
	],
	14: [
		[0, 10, 29, 14],
		[1, 10, 29, 14],
		[2, 30, 23, 14],
		[7, 16, 23, 14],
		[12, 10, 29, 14],
		[17, 16, 23, 14],
		[22, 30, 23, 14],
	],
	15: [
		[0, 7, 1, 28, 15],
		[3, 21, 12, 28, 15],
		[5, 21, 12, 28, 15],
		[6, 24, 1, 28, 15],
		[11, 27, 12, 28, 15],
		[11, 24, 1, 28, 15],
		[14, 7, 1, 28, 15],
		[16, 18, 4, 20, 15],
		[18, 25, 8, 20, 15],
		[19, 5, 8, 20, 15],
		[23, 14, 4, 20, 15],
		[24, 27, 12, 28, 15],
		[26, 7, 1, 28, 15],
		[28, 5, 8, 20, 15],
		[28, 5, 8, 20, 15],
		[29, 14, 4, 20, 15],
		[30, 18, 4, 20, 15],
	],
	16: [
		[0, 7, 16],
		[10, 17, 16],
		[14, 7, 16],
		[19, 17, 16],
		[26, 7, 16],
	],
	17: [
		[0, 10, 17],
		[1, 10, 17],
		[12, 10, 17],
		[13, 19, 17],
		[20, 19, 17],
		[23, 19, 17],
	],
	18: [
		[0, 7, 16, 18],
		[9, 2, 30, 18],
		[10, 17, 16, 18],
		[13, 22, 30, 18],
		[14, 7, 16, 18],
		[19, 17, 16, 18],
		[25, 2, 30, 18],
		[26, 7, 16, 18],
		[26, 22, 30, 18],
	],
	19: [
		[0, 7, 16, 23, 19],
		[0, 10, 29, 13, 19],
		[1, 10, 29, 13, 19],
		[2, 3, 21, 13, 19],
		[9, 2, 30, 23, 19],
		[10, 17, 16, 23, 19],
		[12, 10, 29, 13, 19],
		[13, 22, 30, 23, 19],
		[13, 22, 30, 23, 19],
		[14, 7, 16, 23, 19],
		[15, 25, 8, 20, 19],
		[16, 18, 4, 20, 19],
		[17, 3, 21, 13, 19],
		[18, 25, 8, 20, 19],
		[23, 14, 4, 20, 19],
		[23, 14, 4, 20, 19],
		[25, 2, 30, 23, 19],
		[26, 7, 16, 23, 19],
		[26, 22, 30, 23, 19],
		[28, 5, 21, 13, 19],
		[28, 5, 8, 20, 19],
		[29, 14, 4, 20, 19],
		[30, 18, 4, 20, 19],
	],
	20: [
		[0, 7, 16, 18, 4, 20],
		[0, 10, 29, 14, 4, 20],
		[1, 10, 29, 14, 4, 20],
		[1, 28, 15, 25, 8, 20],
		[2, 30, 18, 25, 8, 20],
		[2, 30, 23, 14, 4, 20],
		[7, 1, 28, 5, 8, 20],
		[7, 16, 23, 14, 4, 20],
		[7, 16, 18, 25, 8, 20],
		[9, 2, 30, 18, 4, 20],
		[10, 17, 16, 18, 4, 20],
		[12, 10, 29, 14, 4, 20],
		[12, 28, 15, 25, 8, 20],
		[13, 22, 30, 18, 4, 20],
		[14, 7, 16, 18, 4, 20],
		[14, 7, 16, 18, 4, 20],
		[16, 23, 19, 5, 8, 20],
		[17, 16, 23, 14, 4, 20],
		[17, 16, 18, 25, 8, 20],
		[19, 17, 16, 18, 4, 20],
		[21, 13, 19, 5, 8, 20],
		[21, 12, 28, 5, 8, 20],
		[22, 30, 18, 25, 8, 20],
		[22, 30, 23, 14, 4, 20],
		[24, 1, 28, 5, 8, 20],
		[25, 2, 30, 18, 4, 20],
		[26, 7, 16, 18, 4, 20],
		[26, 22, 30, 18, 4, 20],
		[27, 12, 28, 5, 8, 20],
		[29, 13, 19, 5, 8, 20],
		[30, 23, 19, 5, 8, 20],
	],
	21: [
		[0, 10, 17, 3, 21],
		[1, 10, 17, 3, 21],
		[4, 20, 19, 5, 21],
		[7, 1, 28, 5, 21],
		[8, 20, 19, 5, 21],
		[12, 10, 17, 3, 21],
		[13, 19, 17, 3, 21],
		[15, 25, 2, 3, 21],
		[16, 23, 19, 5, 21],
		[18, 25, 2, 3, 21],
		[20, 19, 17, 3, 21],
		[23, 19, 17, 3, 21],
		[24, 1, 28, 5, 21],
		[27, 12, 28, 5, 21],
		[27, 9, 2, 3, 21],
		[29, 13, 19, 5, 21],
		[30, 23, 19, 5, 21],
	],
	22: [
		[0, 10, 29, 13, 22],
		[1, 10, 29, 13, 22],
		[1, 28, 15, 26, 22],
		[2, 3, 9, 26, 22],
		[2, 3, 21, 13, 22],
		[4, 20, 15, 26, 22],
		[8, 20, 15, 26, 22],
		[11, 27, 9, 26, 22],
		[12, 10, 29, 13, 22],
		[12, 28, 15, 26, 22],
		[17, 3, 9, 26, 22],
		[17, 3, 21, 13, 22],
		[19, 5, 21, 13, 22],
		[24, 27, 9, 26, 22],
		[28, 5, 21, 13, 22],
	],
	23: [
		[0, 7, 16, 23],
		[9, 2, 30, 23],
		[10, 17, 16, 23],
		[13, 22, 30, 23],
		[14, 7, 16, 23],
		[19, 17, 16, 23],
		[25, 2, 30, 23],
		[26, 7, 16, 23],
		[26, 22, 30, 23],
	],
	24: [
		[0, 7, 16, 18, 4, 11, 24],
		[0, 10, 29, 13, 22, 6, 24],
		[0, 10, 29, 14, 4, 11, 24],
		[1, 10, 29, 13, 22, 6, 24],
		[1, 10, 29, 14, 4, 11, 24],
		[1, 28, 5, 8, 6, 11, 24],
		[1, 28, 15, 26, 22, 6, 24],
		[1, 28, 15, 25, 8, 6, 24],
		[2, 3, 9, 26, 22, 6, 24],
		[2, 3, 21, 13, 22, 6, 24],
		[2, 30, 18, 25, 8, 6, 24],
		[2, 30, 23, 14, 4, 11, 24],
		[3, 9, 26, 22, 6, 11, 24],
		[3, 21, 13, 22, 6, 11, 24],
		[4, 20, 15, 26, 22, 6, 24],
		[4, 20, 15, 25, 8, 6, 24],
		[4, 20, 19, 5, 8, 6, 24],
		[5, 21, 13, 22, 6, 11, 24],
		[7, 1, 28, 5, 8, 6, 24],
		[7, 16, 23, 14, 4, 11, 24],
		[7, 16, 18, 25, 8, 6, 24],
		[8, 20, 15, 26, 22, 6, 24],
		[8, 20, 15, 26, 22, 6, 24],
		[9, 2, 30, 18, 4, 11, 24],
		[10, 17, 16, 18, 4, 11, 24],
		[10, 29, 13, 22, 6, 11, 24],
		[11, 27, 9, 26, 22, 6, 24],
		[11, 27, 9, 26, 22, 6, 24],
		[12, 10, 29, 13, 22, 6, 24],
		[12, 10, 29, 14, 4, 11, 24],
		[12, 28, 5, 8, 6, 11, 24],
		[12, 28, 15, 26, 22, 6, 24],
		[12, 28, 15, 25, 8, 6, 24],
		[13, 22, 30, 18, 4, 11, 24],
		[13, 19, 5, 8, 6, 11, 24],
		[14, 7, 16, 18, 4, 11, 24],
		[14, 7, 16, 18, 4, 11, 24],
		[16, 23, 19, 5, 8, 6, 24],
		[16, 18, 25, 8, 6, 11, 24],
		[17, 16, 23, 14, 4, 11, 24],
		[17, 16, 18, 25, 8, 6, 24],
		[17, 3, 9, 26, 22, 6, 24],
		[17, 3, 21, 13, 22, 6, 24],
		[19, 17, 16, 18, 4, 11, 24],
		[19, 5, 21, 13, 22, 6, 24],
		[20, 15, 26, 22, 6, 11, 24],
		[20, 15, 25, 8, 6, 11, 24],
		[20, 19, 5, 8, 6, 11, 24],
		[21, 13, 19, 5, 8, 6, 24],
		[21, 12, 28, 5, 8, 6, 24],
		[22, 30, 18, 25, 8, 6, 24],
		[22, 30, 23, 14, 4, 11, 24],
		[22, 30, 18, 25, 8, 6, 24],
		[23, 19, 5, 8, 6, 11, 24],
		[25, 2, 30, 18, 4, 11, 24],
		[26, 7, 16, 18, 4, 11, 24],
		[26, 22, 30, 18, 4, 11, 24],
		[27, 12, 28, 5, 8, 6, 24],
		[27, 9, 26, 22, 6, 11, 24],
		[28, 5, 21, 13, 22, 6, 24],
		[28, 15, 26, 22, 6, 11, 24],
		[28, 15, 25, 8, 6, 11, 24],
		[29, 13, 19, 5, 8, 6, 24],
		[30, 18, 25, 8, 6, 11, 24],
		[30, 23, 19, 5, 8, 6, 24],
	],
	25: [
		[0, 7, 16, 18, 25],
		[5, 8, 20, 15, 25],
		[7, 1, 28, 15, 25],
		[9, 2, 30, 18, 25],
		[10, 17, 16, 18, 25],
		[13, 22, 30, 18, 25],
		[14, 7, 16, 18, 25],
		[14, 4, 20, 15, 25],
		[18, 4, 20, 15, 25],
		[18, 4, 20, 15, 25],
		[19, 17, 16, 18, 25],
		[21, 12, 28, 15, 25],
		[24, 1, 28, 15, 25],
		[26, 7, 16, 18, 25],
		[26, 22, 30, 18, 25],
		[27, 12, 28, 15, 25],
	],
	26: [
		[0, 7, 1, 28, 15, 26],
		[0, 10, 17, 3, 9, 26],
		[1, 10, 17, 3, 9, 26],
		[3, 21, 12, 28, 15, 26],
		[4, 11, 24, 27, 9, 26],
		[5, 21, 12, 28, 15, 26],
		[6, 11, 24, 27, 9, 26],
		[6, 11, 24, 27, 9, 26],
		[6, 24, 1, 28, 15, 26],
		[8, 6, 11, 27, 9, 26],
		[8, 6, 24, 27, 9, 26],
		[11, 27, 12, 28, 15, 26],
		[11, 24, 1, 28, 15, 26],
		[12, 10, 17, 3, 9, 26],
		[13, 19, 17, 3, 9, 26],
		[14, 7, 1, 28, 15, 26],
		[14, 4, 11, 27, 9, 26],
		[15, 25, 2, 3, 9, 26],
		[15, 25, 2, 3, 9, 26],
		[16, 18, 4, 20, 15, 26],
		[18, 25, 8, 20, 15, 26],
		[18, 25, 2, 3, 9, 26],
		[18, 4, 11, 27, 9, 26],
		[19, 5, 8, 20, 15, 26],
		[20, 19, 17, 3, 9, 26],
		[22, 6, 11, 27, 9, 26],
		[22, 6, 24, 27, 9, 26],
		[23, 19, 17, 3, 9, 26],
		[23, 14, 4, 20, 15, 26],
		[24, 27, 12, 28, 15, 26],
		[28, 5, 8, 20, 15, 26],
		[28, 5, 8, 20, 15, 26],
		[29, 14, 4, 20, 15, 26],
		[30, 18, 4, 20, 15, 26],
	],
	27: [
		[0, 7, 16, 18, 4, 11, 27],
		[0, 10, 29, 14, 4, 11, 27],
		[1, 10, 29, 14, 4, 11, 27],
		[1, 28, 5, 8, 6, 11, 27],
		[1, 28, 5, 8, 6, 24, 27],
		[2, 30, 18, 4, 11, 24, 27],
		[2, 30, 23, 14, 4, 11, 27],
		[3, 9, 26, 22, 6, 11, 27],
		[3, 9, 26, 22, 6, 24, 27],
		[3, 21, 13, 22, 6, 11, 27],
		[3, 21, 13, 22, 6, 24, 27],
		[5, 21, 13, 22, 6, 11, 27],
		[5, 21, 13, 22, 6, 24, 27],
		[7, 16, 23, 14, 4, 11, 27],
		[7, 16, 18, 4, 11, 24, 27],
		[9, 2, 30, 18, 4, 11, 27],
		[9, 26, 22, 6, 11, 24, 27],
		[10, 17, 16, 18, 4, 11, 27],
		[10, 29, 13, 22, 6, 11, 27],
		[10, 29, 13, 22, 6, 24, 27],
		[10, 29, 14, 4, 11, 24, 27],
		[12, 10, 29, 14, 4, 11, 27],
		[12, 28, 5, 8, 6, 11, 27],
		[12, 28, 5, 8, 6, 24, 27],
		[13, 22, 30, 18, 4, 11, 27],
		[13, 19, 5, 8, 6, 11, 27],
		[13, 19, 5, 8, 6, 24, 27],
		[14, 7, 16, 18, 4, 11, 27],
		[14, 7, 16, 18, 4, 11, 27],
		[15, 26, 22, 6, 11, 24, 27],
		[15, 25, 8, 6, 11, 24, 27],
		[16, 23, 14, 4, 11, 24, 27],
		[16, 18, 25, 8, 6, 11, 27],
		[16, 18, 25, 8, 6, 24, 27],
		[17, 16, 23, 14, 4, 11, 27],
		[17, 16, 18, 4, 11, 24, 27],
		[18, 25, 8, 6, 11, 24, 27],
		[19, 17, 16, 18, 4, 11, 27],
		[19, 5, 8, 6, 11, 24, 27],
		[20, 15, 26, 22, 6, 11, 27],
		[20, 15, 26, 22, 6, 24, 27],
		[20, 15, 25, 8, 6, 11, 27],
		[20, 15, 25, 8, 6, 24, 27],
		[20, 19, 5, 8, 6, 11, 27],
		[20, 19, 5, 8, 6, 24, 27],
		[21, 13, 22, 6, 11, 24, 27],
		[22, 30, 18, 4, 11, 24, 27],
		[22, 30, 23, 14, 4, 11, 27],
		[23, 19, 5, 8, 6, 11, 27],
		[23, 19, 5, 8, 6, 24, 27],
		[25, 2, 30, 18, 4, 11, 27],
		[26, 7, 16, 18, 4, 11, 27],
		[26, 22, 30, 18, 4, 11, 27],
		[28, 5, 8, 6, 11, 24, 27],
		[28, 15, 26, 22, 6, 11, 27],
		[28, 15, 26, 22, 6, 24, 27],
		[28, 15, 25, 8, 6, 11, 27],
		[28, 15, 25, 8, 6, 24, 27],
		[29, 13, 22, 6, 11, 24, 27],
		[30, 18, 25, 8, 6, 11, 27],
		[30, 18, 25, 8, 6, 24, 27],
		[30, 23, 14, 4, 11, 24, 27],
	],
	28: [
		[0, 7, 1, 28],
		[3, 21, 12, 28],
		[5, 21, 12, 28],
		[6, 24, 1, 28],
		[11, 27, 12, 28],
		[11, 24, 1, 28],
		[14, 7, 1, 28],
		[24, 27, 12, 28],
		[26, 7, 1, 28],
	],
	29: [
		[0, 10, 29],
		[1, 10, 29],
		[12, 10, 29],
	],
	30: [
		[0, 10, 29, 13, 22, 30],
		[1, 10, 29, 13, 22, 30],
		[1, 28, 15, 26, 22, 30],
		[1, 28, 15, 25, 2, 30],
		[2, 3, 9, 26, 22, 30],
		[2, 3, 21, 13, 22, 30],
		[2, 3, 9, 26, 22, 30],
		[2, 3, 21, 13, 22, 30],
		[4, 20, 15, 26, 22, 30],
		[4, 20, 15, 25, 2, 30],
		[4, 11, 27, 9, 2, 30],
		[6, 11, 27, 9, 2, 30],
		[6, 24, 27, 9, 2, 30],
		[7, 16, 18, 25, 2, 30],
		[8, 20, 15, 26, 22, 30],
		[8, 20, 15, 25, 2, 30],
		[10, 17, 3, 9, 2, 30],
		[11, 27, 9, 26, 22, 30],
		[11, 24, 27, 9, 2, 30],
		[11, 24, 27, 9, 2, 30],
		[12, 10, 29, 13, 22, 30],
		[12, 28, 15, 26, 22, 30],
		[12, 28, 15, 25, 2, 30],
		[17, 16, 18, 25, 2, 30],
		[17, 3, 9, 26, 22, 30],
		[17, 3, 21, 13, 22, 30],
		[19, 17, 3, 9, 2, 30],
		[19, 5, 21, 13, 22, 30],
		[24, 27, 9, 26, 22, 30],
		[28, 5, 21, 13, 22, 30],
	],
}

const quests = {
	1: {
		room: 23,
		goal: "Basket of eggs (basket)",
	}, 
	2: {
		room: 24,
		goal: "The Golden Egg (ads_pib)",
	}, 
	3: {
		room: 18,
		goal: "Golden Goose Egg (CF_500_egg)",
	}, 
	4: {
		room: 19,
		goal: "Mini Habberge Egg (CF_750_minihabberge)",
	}, 
	5: {
		room: 14,
		goal: "Enchanted Egg (easter_c19_forrestegg)",
	}, 
	6: {
		room: 11,
		goal: "Delectable Chocolate Egg (easter_c23_chocoegg)",
	}, 
	7: {
		room: 15,
		goal: "Luminescent Palm (easter14_palmtree)",
	}, 
	8: {
		room: 22,
		goal: "Giant Egg Basket (easter_r21_gianteggbasket)",
	}, 
	9: {
		room: 28,
		goal: "Velociraptor Egg (velociraptor_egg)",
	}, 
	10: {
		room: 13,
		goal: "Basket of eggs (easter11_basket)",
	}, 
	11: {
		room: 5,
		goal: "Egg Plant (easter14_eggplant)",
	}, 
	12: {
		room: 30,
		goal: "Death Egg-Star (easter14_eggstar)",
	}, 
	13: {
		room: 1,
		goal: "Pterodactyl Egg (pterosaur_egg)",
	}, 
	14: {
		room: 4,
		goal: "Egg Tag Pole (easter11_tag)",
	}, 
	15: {
		room: 16,
		goal: "Golden Egg (xmas_c16_egg)",
	},
}

const easter_eggs = {
	1: {
		room: 6,
		goal: "Walk in some places near the upward arrow",
		prize: "Duckets or furni",
	},
	2: {
		room: 7,
		goal: "Swim in the water to the right",
		prize: "Duckets or furni",
	},
	3: {
		room: 27,
		goal: "Walk next to the mushroom to the right",
		prize: "Duckets or furni",
	},
}

const defaultOption = {
	title: {
		text: 'Easter Egg Hunt 2024'
	},
	tooltip: {},
	animationDurationUpdate: 1500,
	animationEasingUpdate: 'quinticInOut',
	series: [
		{
			type: 'graph',
			layout: 'none',
			symbolSize: 50,
			// roam: true,
			label: {
				show: true
			},
			tooltip: {
				formatter: (a) => {
					if (a.dataType === 'node') {
						return (a.name === '0' ? 'Entrance room' : `Room ${a.name}`) +
							`<br>${(x => x ? `Task ${x[0]} (${x[1].goal})` : 'No task in this room')(Object.entries(quests).find(y => y[1].room === +a.name))}` +
							`${(x => x ? `<br>Hidden secret:<br>- Objective: ${x[1].goal}<br>- Prize: ${x[1].prize}` : '')(Object.entries(easter_eggs).find(y => y[1].room === +a.name))}`
					} else if (a.dataType === 'edge') {
						return `50% chance of going from ${a.data.source === '0' ? 'the entrance' : a.data.source} to ${a.data.target}`
					}
					return ``
				},
			},
			edgeSymbol: ['none', 'arrow'],
			edgeSymbolSize: [4, 10],
			edgeLabel: {
				fontSize: 20
			},
			data: Object.keys(shortestPaths).map(x => ({
				name: x,
				x: (x-1) % 6,
				y: Math.floor((x-1) / 6),
				itemStyle: Object.values(quests).find(y => y.room === +x) ? {
					borderColor: '#fff',
					borderWidth: 3,
					shadowColor: 'rgba(0, 0, 0, 0.5)',
					shadowBlur: 10,
				} : Object.values(easter_eggs).find(y => y.room === +x) ? {
					borderColor: '#fff',
					borderWidth: 1,
					shadowColor: 'rgba(0, 0, 0, 0.5)',
					shadowBlur: 10,
				} : undefined,
			})),
			links: CONNECTIONS.map(c => c.destinations.map(d => ({
					source: c.origin+'',
					target: d+'',
					symbolSize: [0, 10],
					label: {
						// show: true
					},
					lineStyle: {
						width: 1,
						curveness: 0.2
					}
					
				}))).flat(),
		}
	]
};

const otherOptions = Object.keys(shortestPaths).reduce((prev, cur) => {
	let data = [
		...shortestPaths[cur].map(paths => paths.map((p, i) => ({
			name: p,
			x: i,
			y: Math.floor((p-1) / 6),
			symbol : +p === 0 ? 'image://'+hotelDataURI : undefined,
			label: {
				show: +p !== 0,
			},
			itemStyle: +p === +cur ? {
				color: 'white',
				borderColor: 'green',
				borderType: 'dashed',
				...(Object.values(quests).find(y => y.room === +p) ? {
					shadowColor: 'rgba(0, 0, 0, 0.5)',
					shadowBlur: 10,
				} : {}),
			} : Object.values(quests).find(y => y.room === +p) ? {
				borderColor: '#fff',
				borderWidth: 3,
				shadowColor: 'rgba(0, 0, 0, 0.5)',
				shadowBlur: 10,
				color: 'green',
			} : Object.values(easter_eggs).find(y => y.room === +p) ? {
				borderColor: '#fff',
				borderWidth: 1,
				shadowColor: 'rgba(0, 0, 0, 0.5)',
				shadowBlur: 10,
				color: 'green',
			} : {
				color: 'green',
			},
		}))),
		...CONNECTIONS.find(x => +x.origin === +cur).destinations.map(c => ({
			name: c,
			x: shortestPaths[cur][0].length,
			y: 0,
			itemStyle: Object.values(quests).find(y => y.room === +c) ? {
					borderColor: '#fff',
					borderWidth: 3,
					shadowColor: 'rgba(0, 0, 0, 0.5)',
					shadowBlur: 10,
					color: '#ccc',
				} : {
					color: '#ccc',
				},
		})),
	].flat().filter((x, i, a) => a.findIndex(y => y.name === x.name) === i)
			.map((d, i, a) => {
				const curX = a.find(x => x.name === +cur).x
				if (d.itemStyle?.color === 'green' && curX-d.x >= 0) {
					d.itemStyle.color = COLORS[curX-d.x]
				}
				return d
			})
	
	let links = [
	...shortestPaths[cur].map(paths => paths.map((p, i, a) => ({
		source: a[i-1]+'',
		target: p+'',
		symbolSize: [0, 10],
		label: {
		// show: true
		},
		lineStyle: {
		width: 1,
		curveness: 0.1
		}

	}))),
	...CONNECTIONS.find(x => +x.origin === +cur).destinations.map(c => ({
		source: cur+'',
		target: c+'',
		symbolSize: [0, 10],
		label: {
		// show: true
		},
		lineStyle: {
		width: 1,
		curveness: 0.1
		}

	}))
	].flat()
		.filter((x, i, a) => {
		return (
			data.find(y => y.name === +x.target)?.x > data.find(y => y.name === +x.source)?.x ||
			x.source === cur
		) && 
		x.source !== 'undefined' &&
		a.findIndex(y => y.source === x.source && y.target === x.target) === i
		})
	
	let previousData
	do {
		previousData = JSON.stringify(data)
		data = data.filter((d, i, a) => {
			const totalX = a.reduce((prev, cur) => prev+(cur.x === 0 ? 1 : 0), 0)
			if (+d.name === +cur) return true
			if (d.itemStyle?.color === '#ccc') return true
			if (d.x === totalX - 2) return true
			if (d.x === 0 && links.find(l => +l.source === +d.name)) return true
			if (links.find(l => +l.source === +d.name) && links.find(l => +l.target === +d.name)) return true
			return false
		})
		links = links.filter(l => {
			return data.find(d => d.name === +l.source) && data.find(d => d.name === +l.target)
		})

	} while(JSON.stringify(data) !== previousData)
	data = data.map((d, i, a) => {
	const totalX = a.reduce((prev, cur) => prev+(cur.x === 0 ? 1 : 0), 0)
	const withMyX = a.filter(x => x.x === d.x)
	const myIndex = withMyX
		.sort((a, b) => +a.name - +b.name)
		.findIndex(x => x.name === d.name)
	d.y = totalX / 2 - withMyX.length/2 + myIndex
	return d
	})
	
	return {
		...prev,
		[cur]: {
			title: {
				text: `Easter Egg Hunt 2024 - Room ${cur}${(x => x ? ` - Task ${x[0]} (${x[1].goal})` : '')(Object.entries(quests).find(y => y[1].room === +cur))}`
			},
			tooltip: {
				formatter: (a) => {
					if (a.dataType === 'node') {
						return (a.name === '0' ? 'Entrance room' : `Room ${a.name}`) +
							`<br>${(x => x ? `Task ${x[0]} (${x[1].goal})` : 'No task in this room')(Object.entries(quests).find(y => y[1].room === +a.name))}` +
							`${(x => x ? `<br>Hidden secret:<br>- Objective: ${x[1].goal}<br>- Prize: ${x[1].prize}` : '')(Object.entries(easter_eggs).find(y => y[1].room === +a.name))}`
					} else if (a.dataType === 'edge') {
						return `50% chance of going from ${a.data.source === '0' ? 'the entrance' : a.data.source} to ${a.data.target}`
					}
					return ``
				},
			},
			animationDurationUpdate: 1500,
			animationEasingUpdate: 'quinticInOut',
			series: [
				{
					type: 'graph',
					layout: 'none',
					symbolSize: 50,
					// roam: true,
					label: {
						show: true
					},
					edgeSymbol: ['none', 'arrow'],
					edgeSymbolSize: [4, 10],
					edgeLabel: {
						fontSize: 20
					},
					data,
					links,
				}
			]
		}
	}
}, {})

let currentOption = defaultOption
myChart.setOption(currentOption);

myChart.on("click", function (event) {
	const name = event.data.name
	const option = otherOptions[name]
	if (!option && name != 0) return
	currentOption = currentOption === option || !option ? defaultOption : option
	myChart.setOption(currentOption, true);
});

window.addEventListener('resize', myChart.resize);